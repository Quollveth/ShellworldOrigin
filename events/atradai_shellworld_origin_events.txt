event = {
	id = atradai_colleda.5100
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		every_playable_country = {
			limit = { has_origin = origin_shellworld }
			country_event = { id = atradai_colleda.5101 }
		}
	}
}

country_event = {
	id = atradai_colleda.5101
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		country_event = { id = atradai_colleda.5010 }
		capital_scope = {
			generate_start_pops = yes
			add_deposit = d_atra_ruined_colleda
			add_deposit = d_atra_colleda_job_manager
			
			if = {
				limit = { owner = { is_lithoid_empire = yes NOT = { has_valid_civic = civic_hive_devouring_swarm } } }
				while = { count = 4 add_deposit = d_hibernating_lithoids } 
			}
		
			if = {
				limit = { owner = { is_lithoid_empire = yes has_valid_civic = civic_hive_devouring_swarm } }
				while = { count = 2 add_deposit = d_hibernating_lithoids }
			}

			remove_all_districts = yes
			remove_all_buildings = yes

			if = {
				limit = {
					owner = { is_regular_empire = yes }
				}
	
				# total - 24 jobs
	
				# 3 jobs
				add_district_and_planet_size_if_needed_effect = {
					district = district_city
				}
	
				if = {
					limit = {
						owner = { NOT = { has_valid_civic = civic_agrarian_idyll } }
					}
					while = {
						count = 2
						add_district_and_planet_size_if_needed_effect = {
							district = district_city
						}
					}
				}
				else = {
					while = {
						count = 2 
						add_district_and_planet_size_if_needed_effect = {
							district = district_farming_uncapped
						}
					}
				}
	
				if = {
					limit = { owner = { is_megacorp = yes } }
					add_district_and_planet_size_if_needed_effect = {
						district = district_city
					}
				}
	
				# 4 - 6 jobs
				if = {
					limit = {
						owner = {
							OR = {
								is_lithoid_empire = no
								has_country_flag = non_lithoid_subspecies
							}
						}
					}
					while = {
						count = 2
						add_district_and_planet_size_if_needed_effect = {
							district = district_farming_uncapped
						}
					}
					if = {
						limit = {
							owner = { has_origin = origin_default }
						}
						add_district_and_planet_size_if_needed_effect = {
							district = district_farming_uncapped
						}
					}
				}
				else = {
					while = {
						count = 2
						add_district_and_planet_size_if_needed_effect = {
							district = district_mining_uncapped
						}
					}
				}
	
				# 4 jobs
				while = {
					count = 2
					add_district_and_planet_size_if_needed_effect = {
						district = district_mining_uncapped
					}
				}
	
				# 2 jobs
				add_district_and_planet_size_if_needed_effect = {
					district = district_srw_commercial
				}
	
				# 4 jobs
				add_district_and_planet_size_if_needed_effect = {
					district = district_mining_uncapped
				}
				add_district_and_planet_size_if_needed_effect = {
					district = district_srw_commercial
				}
	
				# 2 jobs
				if = {
					limit = { owner = { is_megacorp = no } }
					add_district_and_planet_size_if_needed_effect = {
						district = district_srw_commercial
					}
				}
	
				# 3 jobs
				add_building = building_capital
	
				# 2 jobs
				add_building = building_bureaucratic_1
	
				# 2 jobs
				if = {
					limit = {
						owner = {
							has_valid_civic = civic_reanimated_armies
						}
					}
					add_building = building_dread_encampment
	
					solar_system = { #Necromancers do not give engineering. So make sure there's some readily-accessible engineering
						random_system_planet = {
							limit = {
								has_deposit_for = shipclass_research_station
								has_deposit = d_engineering_5
							}
							# Total size 15 deposit as the Irreparable Damage is normally a size 5 and non-Shattered Ring starts get an additional two size 6 deposits.
							add_deposit = d_engineering_10
						}
					}
				}
				else = {
					add_building = building_research_lab_1
				}
	
				# 4-5 jobs
				if = {
					limit = {
						owner = {
							NOT = { has_valid_civic = civic_agrarian_idyll }
						}
					}
					if = {
						limit = {
							owner = {
								is_spiritualist = no
								has_valid_civic = civic_pleasure_seekers
							}
						}
						add_building = building_holo_theatres
						add_district_and_planet_size_if_needed_effect = {
							district = district_srw_commercial
						}
					}
					else_if = {
						limit = {
							owner = {
								is_spiritualist = yes
								has_valid_civic = civic_death_cult
							}
						}
						add_building = building_sacrificial_temple_1
						add_district_and_planet_size_if_needed_effect = {
							district = district_srw_commercial
						}
					}
					else_if = {
						limit = {
							owner = {
								is_megacorp = no
								is_spiritualist = yes
							}
						}
						add_building = building_temple
						add_district_and_planet_size_if_needed_effect = {
							district = district_srw_commercial
						}
					}
					else = {
						add_building = building_commercial_zone
					}
				}
			}
			
			if = {
				limit = {
					owner = { is_hive_empire = yes }
				}
	
				# 9 jobs
				while = {
					count = 3
					add_district_and_planet_size_if_needed_effect = {
						district = district_hive
					}
				}
	
				# 6-9 jobs
				if = {
					limit = {
						owner = { is_lithoid_empire = no }
					}
					while = {
						count = 2
						add_district_and_planet_size_if_needed_effect = {
							district = district_farming_uncapped
						}
					}
				}
				else = {
					while = {
						count = 2
						add_district_and_planet_size_if_needed_effect = {
							district = district_mining_uncapped
						}
					}
				}
	
				# 6 jobs
				while = {
					count = 2
					add_district_and_planet_size_if_needed_effect = {
						district = district_mining_uncapped
					}
				}
	
				# 6 jobs
				while = {
					count = 2
					add_district_and_planet_size_if_needed_effect = {
						district = district_generator_uncapped
					}
				}
	
				# 2 jobs
				add_district_and_planet_size_if_needed_effect = {
					district = district_mining_uncapped
				}
	
				# 5 jobs
				add_building = building_hive_capital
	
				# 2 jobs
				add_building = building_research_lab_1
	
				# 2 jobs
				add_building = building_hive_node
	
				# 1 job
				add_building = building_spawning_pool
			}

			if = {
				limit = { owner = { is_machine_empire = yes } }
	
				# total - 27 jobs
	
				# 3 jobs
				while = {
					count = 2
					add_district_and_planet_size_if_needed_effect = {
						district = district_nexus
					}
				}
	
				# 2 jobs
				add_district_and_planet_size_if_needed_effect = {
					district = district_mining_uncapped
				}
	
				# 6 jobs
				add_building = building_machine_capital
	
				# 1 job
				add_building = building_machine_assembly_plant
	
				# 2 job
				add_building = building_uplink_node
	
				# 2 jobs
				add_building = building_research_lab_1
	
				# 4 jobs
				add_district_and_planet_size_if_needed_effect = {
					district = district_mining_uncapped
				}
	
				# 8 jobs
				while = {
					count = 4
					add_district_and_planet_size_if_needed_effect = {
						district = district_generator_uncapped
					}
				}
	
				#Assimilators
				if = {
					limit = { owner = { has_civic = civic_machine_assimilator } }
					remove_district = district_generator_uncapped
					if = {
						limit = { owner = { has_country_flag = lithoid_subspecies } }
						add_district_and_planet_size_if_needed_effect = {
							district = district_mining_uncapped
						}
					}
					else = {
						add_district_and_planet_size_if_needed_effect = {
							district = district_farming_uncapped
						}
					}
				}
	
				#Servitors
				if = {
					limit = { owner = { has_civic = civic_machine_servitor } }
					if = {
						limit = { owner = { has_country_flag = lithoid_subspecies } }
						add_district_and_planet_size_if_needed_effect = {
							district = district_mining_uncapped
						}
					}
					else = {
						add_district_and_planet_size_if_needed_effect = {
							district = district_farming_uncapped
						}
					}
					add_district_and_planet_size_if_needed_effect = {
						district = district_nexus
					}
					add_building = building_organic_sanctuary
				}
			}

			every_owned_pop = {
				unemploy_pop = yes
				clear_pop_category = yes
			}
			check_planet_employment = yes

			# above is copy pasted, shellworld stuff comes here
			set_planet_size = 1
			add_building = colleda_layer_management_center
			add_deposit = d_colleda_ruins_1
			add_deposit = d_colleda_ruins_1
			add_deposit = d_colleda_ruins_2
			add_deposit = d_colleda_ruins_3
			add_deposit = d_colleda_ruins_4
		}
	}
}

planet_event = {
	id = atradai_colleda.5102
	hide_window = yes
	is_triggered_only = yes
	trigger = { is_planet_class = pc_colleda }
	immediate = {
		owner = {
			country_event = {
				id = atradai_colleda.5103
			}
		}
	}
}

country_event = {
	id = atradai_colleda.5103
	title = atradai_colleda.5103.name
	desc = atradai_colleda.5103.desc
	picture = GFX_evt_city_planet
	is_triggered_only = yes
	option = { name = atradai_colleda.5103.a }
}